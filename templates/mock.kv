#:import OneUIColors configs.color.OneUIColors

#:import OneUIMockView features.mock.view.OneUIMockView
#:import OneUIMockAdd features.mock.add.OneUIMockAdd

#:import STATUS_CODES configs.codes.STATUS_CODES
#:import CONTENT_TYPES configs.codes.CONTENT_TYPES
#:import FILTER_BY_OPTIONS configs.codes.FILTER_BY_OPTIONS
#:import OPERATORS configs.codes.OPERATORS
#:import HTTP_METHODS configs.codes.HTTP_METHODS

#:import OneUITextField widgets.text.OneUITextField
#:import OneUIButton widgets.button.OneUIButton
#:import OneUIComboDropdown widgets.combo.OneUIComboDropdown
#:import NumberInputField widgets.text.NumberInputField

<OneUIMockPage>:
    MDGridLayout:
        cols: 1
        rows: 2
        md_bg_color: rgba("#B7B7B7")
        MDToolbar:
            md_bg_color: app.theme_cls.primary_color
            title: "Mock"
            right_action_items: [ ["plus-box", lambda x: root.switch("mock_add")], ["view-list", lambda x: root.switch("mock_view")], ["menu-right-outline", lambda x: root.nav_drawer.set_state("toggle")]]
        ScreenManager:
            id: mock_screen_manager
            MDScreen:
                name: "mock_view"
                OneUIMockView:
            OneUIMockAdd:
                name: "mock_add"

<OneUIMockAdd>:
    responses: responses
    ScrollView:
        do_scroll_x: False
        do_scroll_y: True
        MDBoxLayout:
            adaptive_height: True
            orientation: "vertical"
            padding: 25
            spacing: 20
            OneUIBox:
                orientation: "vertical"
                spacing: 20
                adaptive_height: True
                OneUITextField:
                    id: given_name
                    hint_text: "Endpoint Identifier"
                    size_hint: 1, None
                    height: "50dp"

                OneUITextArea:
                    id: mock_description
                    hint_text: "Description"
                    size_hint: 1, None
                    height: "150dp"


            # Add response tab here
            MDList:
                cols: 1
                id: responses
                spacing: dp(10)
                adaptive_height: True

            OneUIStrokeButton:
                size_hint: None, None
                width: dp(100)
                height: dp(40)
                text: "+  Add More"
                border_radius: 0
                on_release: root.add_response()
                back_color: app.theme_cls.primary_color

            OneUIButton:
                size_hint: None, None
                width: dp(100)
                height: dp(40)
                text: "Save"
                border_radius: [0]
                back_color: app.theme_cls.primary_color
                on_release: root.save()

# Mock Rules
<OneUIAddMockResponseRules>:
    orientation: "vertical"
    adaptive_height: True
    spacing: 10
    padding: 30
    md_bg_color: [1, 1, 1, .7]
    OneUIBox:
        orientation: "vertical"
        spacing: 15
        adaptive_height: True
        id: mock_rules
    OneUIStrokeButton:
        size_hint: None, None
        width: dp(100)
        height: dp(40)
        markup: True
        text: "[b]Add rules[/b]"
        back_color: OneUIColors.SaveButton.value
        border_radius: 0
        back_color: app.theme_cls.primary_color
        on_release: root.add()

# Mock response rules
<OneUIAddMockResponseRule>:
    cols: 5
    adaptive_height: True
    md_bg_color: app.theme_cls.primary_color
    OneUIComboDropdown:
        id: mock_fil ter_type
        size_hint: None, 1
        width: dp(150)
        placeholder: "Filter By"
        items: FILTER_BY_OPTIONS.keys()

    OneUITextField:
        id: mock_filter_key
        hint_text: "Key"

    OneUIComboDropdown:
        id: mock_filter_operator
        size_hint: 1, None
        width: dp(150)
        items: OPERATORS.keys()
        placeholder: "Condition"

    OneUITextField:
        id: mock_filter_value
        hint_text: "Value"

    MDIconButton:
        theme_text_color: "Custom"
        on_release: root.on_delete()
        icon: "trash-can"
        text_color: [1, 1, 1, .8]



# Mock response headers
<OneUIMOckResponseHeaders>
    spacing: 20
    orientation: "vertical"
    adaptive_height: True
    md_bg_color: [1, 1, 1, .7]
    padding: [30]
    headers: headers
    OneUIBox:
        orientation: "vertical"
        spacing: 20
        adaptive_height: True
        id: headers
    OneUIStrokeButton:
        markup: True
        text: "[b]Add header[/b]"
        border_radius: 0
        size_hint: None, None
        width: dp(100)
        height: dp(40)
        back_color: app.theme_cls.primary_color
        on_release: root.add()

# Mock response status, content-type and body
<OneUIMOckResponseData>
    cols: 1
    spacing: 20
    adaptive_height: True
    padding: 30
    md_bg_color: [1, 1, 1, .7]
    OneUIGrid:
        cols: 3
        spacing: dp(20)
        adaptive_height: True
        OneUIComboDropdown:
            id: http_method
            placeholder: 'Http Method'
            size_hint_x: None
            width: "160dp"
            items: HTTP_METHODS.keys()

        OneUITextField:
            id: mock_data_point
            hint_text: "Path ( regex, query or leave it empty to auto generate )"
            size_hint: 1, None
            height: "50dp"

        NumberInputField:
            id: response_delay
            hint_text: "Delay"
            size_hint_x: None
            width: "100dp"
            start: 0
            end: 60
            halign: 'center'


    OneUIGrid:
        cols: 2
        adaptive_height: True
        spacing: "20dp"
        OneUIComboDropdown:
            id: mock_http_content_type
            items: CONTENT_TYPES
            placeholder: "Content Type"
        OneUIComboDropdown:
            id: mock_http_status_code
            helper_text: 'Http Method'
            items: STATUS_CODES.keys()
            placeholder: "Status Codes"

    OneUIGrid:
        cols: 2
        adaptive_height: True
        size_hint: 1, None
        row_default_height: dp(50)
        row_force_default: True

        OneUITextField:
            id: mock_data_file
            hint_text: "Path of the data file i.e. /user/data/email.json"
            size_hint: 1, None
            height: dp(50)

        OneUIBox:
            orientation: "vertical"
            padding: 3
            size_hint: ( None, 1 )
            width: dp(100)
            md_bg_color: OneUIColors.Background.value
            size_hint: None, None
            size: dp(50), dp(50)
            MDIconButton:
                icon: "file-search"
                theme_text_color: "Custom"
                text_color: [1, 1, 1, 1]
    OneUIBox:
        adaptive_height: True
        orientation: "vertical"
        OneUITextField:
            id: mock_data
            hint_text: "Data"
            multiline: True
            size_hint_y: None
            height: "300dp"
# Response section header buttons
<OneUIMockResponseHeaderPanel>:
    adaptive_height: True
    padding: [ 1, 1, 1, 1 ]
    OneUILeftSide:
        OneUIHorizontalList:
            md_bg_color: [0, 0, 0, 0]
            cols: 3
            rows: 1
            spacing: 1
            border_radius:[ 0 ]
            adaptive_height: True
            OneUIButton:
                back_color: [ 0, 0, 0, 0.2]
                text: "Data"
                font_size: "15sp"
                width: dp(100)
                height: dp(55)
                border_radius:[ 0 ]
                on_release: root.load_data_page()
            OneUIButton:
                back_color: [ 0, 0, 0, 0.2 ]
                text: "Headers"
                font_size: "15sp"
                width: dp(100)
                height: dp(55)
                border_radius:[ 0 ]
                on_release: root.load_headers_page()
            OneUIButton:
                back_color: [ 0, 0, 0, 0.2 ]
                text: "Rules"
                font_size: "15sp"
                width: dp(100)
                height: dp(55)
                border_radius:[ 0 ]
                on_release: root.load_rules_page()
    OneUIRightSide:
        md_bg_color: [1, 1, 1, 1]
        MDIconButton:
            icon: "close-outline"
            theme_text_color: "Custom"
            on_release: root.remove()
            text_color: [1, 1, 1, .8]

<OneUIMockHeader>:
    adaptive_height: True
    spacing: dp(1)
    cols: 3
    rows: 1
    md_bg_color: app.theme_cls.primary_color
    OneUITextField:
        id: header_key_field
        hint_text: "Header Key"
    OneUITextField:
        id: header_value_field
        hint_text: "Header Value"
    MDIconButton:
        icon: "trash-can"
        theme_text_color: "Custom"
        text_color: [1, 1, 1, .8]
        on_release: root.on_delete()

